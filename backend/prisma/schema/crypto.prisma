model CryptoPortfolio {
  id                 String                    @id @default(uuid())
  userId             Int
  exchanges          String                    @default("binance")
  tradingType        TradingType
  apiKey             String
  secretKey          String
  updateTime         DateTime?
  balances           AssetBalance[]
  user               User                      @relation(fields: [userId], references: [id])
  historicalBalances HistoricalCryptoBalance[]
}

model AssetBalance {
  id                String          @id @default(uuid())
  assetInfoId       String
  balance           Float
  locked            Float
  cryptoPortfolioId String
  assetInfo         AssetInfo       @relation(fields: [assetInfoId], references: [id])
  cryptoPortfolio   CryptoPortfolio @relation(fields: [cryptoPortfolioId], references: [id])
}

model AssetInfo {
  id            String         @id @default(uuid())
  name          String
  symbol        String
  category      String
  desc          String
  logo          String
  assetBalances AssetBalance[]
  assetPrices   AssetPrice[]
}

model AssetPrice {
  assetInfoId String
  interval    String
  open_time   DateTime
  close_time  DateTime
  openPrice   Float
  closePrice  Float
  highPrice   Float
  lowPrice    Float
  volume      Float
  assetInfo   AssetInfo @relation(fields: [assetInfoId], references: [id])

  @@unique([assetInfoId, open_time])
}

model HistoricalCryptoBalance {
  time              DateTime
  estimatedBalance  Float
  changePercent     Float
  changeBalance     Float
  cryptoPortfolioId String
  cryptoPortfolio   CryptoPortfolio @relation(fields: [cryptoPortfolioId], references: [id])

  @@unique([cryptoPortfolioId, time])
}

enum TradingType {
  FUTURES
  SPOT
}
